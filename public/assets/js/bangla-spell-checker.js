function SpellCheck(n,t){SpellCheck.prototype.configure=function(n,t){var r=this,e,u,f;for(r.view=n,r.server=t,e=function(n){r.view.checkingStarted(r._textObjects[n])},r._misspelledWords=new SpellCheck.internal.MisspelledWords(t,e),u=[],f="",f=typeof Storage!="undefined"?localStorage.bpLocalDic:r.getCookie("dic_bangla.plus"),f&&(u=JSON.parse(f)),i=0;i<u.length;i++)r._ignoredWords[u[i]]=!0;r._contextManager=new SpellCheck.internal.ContextManager(r._textObjects,r._misspelledWords,function(){var n=r._contextManager.getContext();n.word&&r.isIgnored(n.word)?r._contextManager.step():r._updateView()})};SpellCheck.prototype.open=function(){this.view.open();this._contextManager.step()};SpellCheck.prototype.close=function(){this.view.close();t(this._textObjects)};SpellCheck.prototype._updateView=function(){var n=this._contextManager.getContext(),t=this._textObjects,i=this._lastAction!=null,r=n.textObjectIndex<t.length-1;this.view.update(t[n.textObjectIndex],n,i,r)};SpellCheck.prototype.ignore=function(){this._lastAction=new SpellCheck.internal.IgnoreAction(this._contextManager.getContext());this._contextManager.step()};SpellCheck.prototype.getCookie=function(n){for(var t,r=n+"=",u=document.cookie.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return""};SpellCheck.prototype.setCookie=function(n,t,i){var r=new Date,u;r.setTime(r.getTime()+i*864e5);u="expires="+r.toUTCString();document.cookie=n+"="+t+";"+u+";path=/"};SpellCheck.prototype.learn=function(){var i=this,r=i._contextManager.getContext(),n=[],t;typeof Storage!="undefined"?(t=localStorage.bpLocalDic,t&&(n=JSON.parse(t)),n.indexOf(r.word)===-1&&(n.push(r.word),localStorage.bpLocalDic=JSON.stringify(n))):(t=i.getCookie("dic_bangla.plus"),t&&(n=JSON.parse(t)),n.indexOf(r.word)===-1&&(n.push(r.word),i.setCookie("dic_bangla.plus",JSON.stringify(n),90)));i.server.learn(r.word,function(){i.ignoreAll()})};SpellCheck.prototype.ignoreAll=function(){this._lastAction=new SpellCheck.internal.IgnoreAllAction(this._ignoredWords,this._contextManager.getContext());this._contextManager.step()};SpellCheck.prototype.undo=function(){this._lastAction&&(this._contextManager.setContext(this._lastAction.undo()),this._updateView())};SpellCheck.prototype.replace=function(n){this._lastAction=new SpellCheck.internal.ReplaceAction(this._textObjects,this._contextManager.getContext(),n);this._contextManager.step()};SpellCheck.prototype.replaceAll=function(n){this._lastAction=new SpellCheck.internal.ReplaceAllAction(this._textObjects,this._contextManager.getContext(),n);this._contextManager.step()};SpellCheck.prototype.skip=function(){this._contextManager.skip()};SpellCheck.prototype.isIgnored=function(n){return this._ignoredWords[n]};SpellCheck.prototype.textObject=function(){var n=this._contextManager.getContext();return this._textObjects[n.textObjectIndex]};SpellCheck.prototype.getSuggestions=function(n){var t=this._contextManager.getContext();return this._misspelledWords.getSuggestions(this.textObject(),n)};SpellCheck.prototype.isMisspelled=function(n){var t=this._contextManager.getContext();return this._misspelledWords.isMisspelled(this.textObject(),n)};SpellCheck.prototype.replaceMisspelled=function(n,t){var i="",u=this.textObject(),r=u.text,f=this;return SpellCheck.eachWord(u,n,function(u,e){return i+=r.substring(n,e),i+=f.isMisspelled(u)?t(u):u,n=e+u.length,!0}),n<r.length&&(i+=r.substring(n)),i};var r=this;r._ignoredWords={};r._textObjects=n instanceof Array?n:[n];r._lastAction=null;r._misspelledWords=null;r._contextManager=null;r.view=null;r.server=null}function BanglaSpeller(n,t,i){var r=$(n),u=function(n){r.val(n[0].text);i&&i(n)},f=BanglaSpellerDialog.create({text:r.val()},u,t);f.open()}SpellCheck.internal={};SpellCheck.internal.IgnoreAction=function(n){SpellCheck.internal.IgnoreAction.prototype.undo=function(){return n}};SpellCheck.internal.IgnoreAllAction=function(n,t){SpellCheck.internal.IgnoreAllAction.prototype.undo=function(){return n[t.word]=!1,t};SpellCheck.internal.IgnoreAllAction.prototype._init=function(){t&&(n[t.word]=!0)};this._init()};SpellCheck.internal.ReplaceAction=function(n,t,i){SpellCheck.internal.ReplaceAction.prototype.undo=function(){var u=n[t.textObjectIndex],r=u.text;return r=r.substring(0,t.wordIndex)+t.word+r.substring(t.wordIndex+i.length),u.text=r,t};SpellCheck.internal.ReplaceAction.prototype._init=function(){if(t){var u=n[t.textObjectIndex],r=u.text;r=r.substring(0,t.wordIndex)+i+r.substring(t.wordIndex+t.word.length);u.text=r}};this._init()};SpellCheck.internal.ReplaceAllAction=function(n,t,i){SpellCheck.internal.ReplaceAllAction.prototype.undo=function(){for(var i=t.textObjectIndex;i<n.length;i++)n[i].text=this._originalTexts.shift();return t};SpellCheck.internal.ReplaceAllAction.prototype._init=function(){var u;if(t){var f=new RegExp("(^|[ \n\r\t.,।'\"+!?-]+)"+t.word+"([ \n\r\t.,।'\"+!?-]+|$)","g"),r=n[t.textObjectIndex],e=r.text;for(this._originalTexts.push(e),r.text=e.substring(0,t.wordIndex)+r.text.substring(t.wordIndex).replace(f,"$1"+i+"$2"),u=t.textObjectIndex+1;u<n.length;u++)r=n[u],this._originalTexts.push(r.text),r.text=r.text.replace(f,"$1"+i+"$2")}};this._originalTexts=[];this._init()};SpellCheck.internal.MisspelledWords=function(n,t){var i=1;SpellCheck.internal.MisspelledWords.prototype.check=function(r,u){var o=this,s,f,e;if(r._identifier=i++,s=/([(\u0980-\u09fe)]+)/g,!r.text.match(s)){o._misspelledWords[r._identifier]={};u();return}t();f={};e=[];SpellCheck.eachWord(r,0,function(n){return f[n]!=!0&&(e.push(n),f[n]=!0),!0});n.check(e,function(n){o._misspelledWords[r._identifier]=n;u()})};SpellCheck.internal.MisspelledWords.prototype.isMisspelled=function(n,t){return typeof this._misspelledWords[n._identifier][t]!="undefined"};SpellCheck.internal.MisspelledWords.prototype.getSuggestions=function(n,t){return this._misspelledWords[n._identifier][t]};SpellCheck.internal.MisspelledWords.prototype.haveWords=function(n){return typeof this._misspelledWords[n._identifier]!="undefined"};this._misspelledWords={}};SpellCheck.internal.ContextManager=function(n,t,i){SpellCheck.internal.ContextManager.prototype.getContext=function(){return this._context};SpellCheck.internal.ContextManager.prototype.setContext=function(n){this._context=n};SpellCheck.internal.ContextManager.prototype.step=function(){var f=this,r=n[this._context.textObjectIndex],u;if(!t.haveWords(r))return t.check(r,function(){f.step()});this._nextLocalContext();u=this._context.textObjectIndex==n.length-1;this._context.wordIndex>=0||u?i&&i(this._context):(this._context=new SpellCheck.Context(this._context.textObjectIndex+1,0),this.step())};SpellCheck.internal.ContextManager.prototype.skip=function(){this._context.textObjectIndex<n.length-1&&(this._context=new SpellCheck.Context(this._context.textObjectIndex+1,0),this.step())};SpellCheck.internal.ContextManager.prototype._nextLocalContext=function(){this._context.word&&(this._context=new SpellCheck.Context(this._context.textObjectIndex,this._context.wordIndex+this._context.word.length));var i=this._context,r=n[i.textObjectIndex];SpellCheck.eachWord(r,i.startIndex,function(n,u){return t.isMisspelled(r,n)?(i.word=n,i.wordIndex=u,!1):!0})};this._context=new SpellCheck.Context(0,0)};SpellCheck.Context=function(n,t){this.textObjectIndex=n;this.startIndex=t;this.word=null;this.wordIndex=-1};SpellCheck.lastNLines=function(n,t){for(var h=/([\r\n])/g,f=null,i=[],e,u,r,o,s;f=h.exec(n);)i.push(f.index);if(i.length<t)return n;for(e=0,u=0,r=i.length-1;r>=0;r--)if(u=i[r],++e==t)break;return o=/^[\r\n]/,s=n.substring(u).replace(o,""),s};SpellCheck.eachWord=function(n,t,i){for(var o=/\S+/g,s=/([(\u0980-\u09fe)]+)/g,f,e,h=n.text.substring(t);f=o.exec(h);){var u=f[0],c=t+f.index;if(!u.match(/^\\/)&&!u.match(/\w+\@\w+\.\w+(\.\w+)?/)&&!u.match(/^https?/))while(e=s.exec(u)){var r=e[0],l=c+e.index;if(!(r.length<2)&&(r.match(/'$/)&&(r=r.substring(0,r.length-1)),!i(r,l))){o.lastIndex=0;s.lastIndex=0;return}}}};var BanglaSpellerDialog={};BanglaSpellerDialog.defaults={loadingImgSrc:"https://bangla.plus/images/loader.gif",spellUrl:"https://bangla.plus/api/checkbanglaspelling/",learnUrl:"https://bangla.plus/api/learnbanglaword/",modal:!0,autoOpen:!0,learn:!0,learnToServer:!1,displayLanguage:"Bangla"};BanglaSpellerDialog.english={title:"Bangla Speller",wrongWordCaption:"Not in Ditionary",suggestionCaption:"Change to",ignoreBtnCaption:"Ignore",ignoreAllBtnCaption:"Ignore All",replaceBtnCaption:"Replace",replaceAllBtnCaption:"Replace All",undoBtnCaption:"Undo",addBtnCaption:"Add to Dictionary",doneBtnCaption:"Done",completedText:"Spell Check Completed.",serverErrorText:"A server error occurred during the spellcheck.",sponsoredByText:"Sponsored by"};BanglaSpellerDialog.bangla={title:"বাংলা স্পেলার",wrongWordCaption:"ভুল শব্দ",suggestionCaption:"পরিবর্তন করুন",ignoreBtnCaption:"এভাবেই থাকুক",ignoreAllBtnCaption:"এভাবেই থাকুক (সব)",replaceBtnCaption:"পরিবর্তন করুন",replaceAllBtnCaption:"পরিবর্তন করুন (সব)",undoBtnCaption:"আগের অবস্থা",addBtnCaption:"অভিধানে যোগ করুন",doneBtnCaption:"বন্ধ করুন",completedText:"বানান চেক করা শেষ হয়েছে।",serverErrorText:"সার্ভারের সমস্যার জন্য বানান চেক করা সম্ভব হচ্ছে না।",sponsoredByText:"সৌজন্যে"};BanglaSpellerDialog.create=function(n,t,i){i=jQuery.extend(BanglaSpellerDialog.defaults,i);i=i.displayLanguage.toLowerCase()=="english"?jQuery.extend(BanglaSpellerDialog.english,i):jQuery.extend(BanglaSpellerDialog.bangla,i);var r=new SpellCheck(n,t),u=new BanglaSpellerDialog.View(r,i);return r.configure(u,new BanglaSpellerDialog.Server(i)),r};BanglaSpellerDialog.Server=function(n){BanglaSpellerDialog.Server.prototype.serverError=function(){alert(n.serverErrorText)};BanglaSpellerDialog.Server.prototype.check=function(t,i){var r=this;jQuery.ajax({type:"POST",dataType:"json",url:n.spellUrl,data:{words:t},error:r.serverError,success:function(n){i(n)}})};BanglaSpellerDialog.Server.prototype.learn=function(t,i){var r=this;n.learnToServer&&jQuery.ajax({type:"POST",dataType:"json",url:n.learnUrl,data:{word:t},error:r.serverError,success:function(){i()}})}};BanglaSpellerDialog.View=function(n,t){BanglaSpellerDialog.View.Template='<div class="controlWindowBody"><table class="controlTable"><tr>   <td colspan="3" class="normalLabel">'+t.wrongWordCaption+':<\/td><\/tr><tr valign="top">\t<td class="leftPnl">\t\t<table>       <tr>       \t<td><input class="readonlyInput" type="text" name="misword" disabled="disabled" /><\/td>       <\/tr>       <tr>       \t<td class="normalLabel">'+t.suggestionCaption+':<\/td>       <\/tr>\t\t<tr>\t\t\t<td class="normalLabel">        \t\t<input class="textDefault" type="text" name="txtsugg" />\t\t\t<\/td>       <\/tr>       <tr>\t\t\t<td> \t\t\t<select class="suggSlct" name="sugg" size="7">\t\t\t\t<option><\/option>\t\t\t<\/select>\t\t\t<\/td>\t\t<\/tr>\t\t<\/table>\t<\/td>\t<td>&nbsp;&nbsp;<\/td>\t<td>       <div>\t\t\t<button class="buttonDefault" name="ignore">'+t.ignoreBtnCaption+'<\/button > \t\t\t<button class="buttonDefault" name="ignoreAll">'+t.ignoreAllBtnCaption+'<\/button>       <\/div>       <div>\t\t\t<button class="buttonDefault" name="replace">'+t.replaceBtnCaption+'<\/button>\t\t\t<button class="buttonDefault" name="replaceAll">'+t.replaceAllBtnCaption+'<\/button>       <\/div>       <div>\t\t\t<button class="buttonDefault" name="undo">'+t.undoBtnCaption+'<\/button>\t\t\t<button class="buttonDefault" name="learn">'+t.addBtnCaption+'<\/button>       <\/div>       <div>\t\t\t<button class="buttonDefault" style="display:none;" name="skip">Next Block<\/button>\t\t\t<button class="buttonDefault" name="close">'+t.doneBtnCaption+'<\/button>       <\/div>\t<\/td><\/tr><\/table><div class="sponsor">   <b>'+t.sponsoredByText+'<\/b>: <a title="Bangla Plus" href="https://bangla.plus/bangla-speller/" target="_blank">bangla.plus<\/a>';"<\/div><\/div > ";BanglaSpellerDialog.View.prototype._createUI=function(){var u=$('<div class="loadingMessage"><img src="'+t.loadingImgSrc+'"/><\/div>').hide(),f=$('<div class="wordWindowText"><\/div>'),e=$('<div class="wordWindow"><\/div>').append(u).append(f),i=$('<div id="spellCheckDialog"><\/div>').append(e).append(BanglaSpellerDialog.View.Template),r=this;return $("button[name=close]",i).click(function(){return n.close(),!1}),$("button[name=replace]",i).click(function(){return n.replace(r.getChangeTo()),!1}),$("button[name=replaceAll]",i).click(function(){return n.replaceAll(r.getChangeTo()),!1}),$("button[name=undo]",i).click(function(){return n.undo(),!1}),$("button[name=ignore]",i).click(function(){return n.ignore(),!1}),$("button[name=ignoreAll]",i).click(function(){return n.ignoreAll(),!1}),$("button[name=skip]",i).click(function(){return n.skip(),!1}),t.learn?$("button[name=learn]",i).click(function(){return n.learn(),!1}):$("button[name=learn]",i).attr("style","display:none;"),$("select",i).change(function(){$("input[name=txtsugg]",i).val($(this).val())}),i};BanglaSpellerDialog.View.prototype.open=function(){this._$dialog=this._createUI().dialog(t)};BanglaSpellerDialog.View.prototype.close=function(){this._$dialog.dialog("close")};BanglaSpellerDialog.View.prototype.getChangeTo=function(){return $("input[name=txtsugg]",this._$dialog).val()};BanglaSpellerDialog.View.prototype.checkingStarted=function(){$(".loadingMessage",this._$dialog).show();$(".wordWindowText",this._$dialog).hide()};BanglaSpellerDialog.View.prototype.update=function(i,r,u,f){var s=this,o,e;$(".loadingMessage",this._$dialog).hide();$(".wordWindowText",this._$dialog).show();r.word==null&&(o=$('<button class="buttonDefault right" onclick="javascript:void(0);">'+t.doneBtnCaption+"<\/button>").click(function(){return n.close(),!1}),e=$('<div class="spellCheckCompleted"><\/div>'),e.append(t.completedText+"  ").append(o),$(".controlWindowBody",this._$dialog).empty().append(e));this._updateWordWin(i,r);this._updateControlWindow(r);u?$("button[name=undo]",this._$dialog).removeAttr("disabled"):$("button[name=undo]",this._$dialog).attr("disabled","disabled");f?$("button[name=skip]",this._$dialog).removeAttr("disabled"):$("button[name=skip]",this._$dialog).attr("disabled","disabled")};BanglaSpellerDialog.View.prototype._updateControlWindow=function(t){var u=t.word,r,i,f;if($("input[name=misword]",this._$dialog).val(u),r=$("select",this._$dialog).empty(),i=n.getSuggestions(u),i){for(f in i)r.append("<option>"+i[f]+"<\/option>");i.length>0&&(r.val(i[0]),r.change())}else $("input[name=txtsugg]",this._$dialog).val("")};BanglaSpellerDialog.View.prototype._updateWordWin=function(t,i){var u=t.text,r="",f,e;i.word!=null?(r=u.substring(0,i.wordIndex),r=SpellCheck.lastNLines(r,10),r+='<span class="currentWord">'+i.word+"<\/span>",f=i.wordIndex+i.word.length,e=n.replaceMisspelled(f,function(t){return n.isIgnored(t)?t:'<span class="misspelled">'+t+"<\/span>"}),r+=e):r=u;$(".wordWindowText",this._$dialog).html(r)};this.spellcheck=n;this._$dialog=null}